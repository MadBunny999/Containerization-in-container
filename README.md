# Containerization-in-container

## Сборка:

```
docker build ./good_dockerfile -t airflow
```

## Запуск контейнера:

```
docker run -v ./dags:/opt/airflow/dags -p 8080:8080 --name airflow airflow
```

## Практики, используемые в работе

| `                       ` :thumbsdown: `                      ` | `                                    ` :thumbsup: `                                 `|
|:-|:-|
| `FROM apache/airflow:latest` | `FROM apache/airflow:slim-latest-python3.9`|
|||
| `RUN airflow users create \` <br> `    --username admin \` <br> `    --password admin \`| `ARG username=admin` <br> `ARG password=admin` <br>`RUN airflow db init && airflow users create \` <br> `                        --username ${username} \` <br> `                        --password ${password}` |
|||
|`RUN apt-get update` <br> `RUN apt-get -y upgrade` <br> `RUN apt-get -y install python3.11`|`RUN apt-get update && apt-get -y upgrade && apt-get -y install python3.11`|

### Подробнее

- [x] **Лучше не использовать тег *`latest`*:**
> ***Почему нет***: <br>
    &cross; 1) Тег `latest` указывет на то, что необходимо использовать новейшую версию <br>
    &cross; 2) В вашем проекте, как правило, зафиксированы определённые зависимости с определёнными версиями <br>
    &cross; 3) Новейшая версия, хоть и звучит классно, но не всегда совместима с вашими зафиксированными зависимостями <br>
    &check; Фиксируйте версии, не используйте тег `latest`
- [x] **Лучше использовать переменные, как аргументы, заранее фиксируя их:**
> ***Почему***: <br>
    &cross; В докерфайле могут быть использованы одни и те же значения параметров много раз, поэтому использование переменных упрощает работу в таких случаях  <br>
    &cross; Значения аргументов могут быть очень длинными, и их использование в коде делает его нечитаемым <br>
    &check; При изменениях в проекте есть необходимость изменять Dockerfile. Если аргументы поданы, как переменные, в дальнейшем тх будет легко измениить
- [x] **Лучше объединять операции RUN по смыслу:** 
> ***Почему***: <br>
    &check; Это позволяет сделать код менее громостким и длинным <br>
    &check; Это ускоряет сборку (преимущества кэширования)  <br>

## Когда не стоит использовать контейнеры в работе

Вообще, контейнеры - прикольная тема, но не всегда в них есть необходимость. Когда же использовать их не следует:

- Ваш проект - это проект новичка, в нём нет сложных зависимостей, которые стоит изолировать, вы не планируете его масштабировать. Тогда контейнеризация излишня
- Ваш проект - это ужас летяший на крыльях ночи, он требует очень большого количества ресурсов (памяти, CPU). Тогда вы просто не сможете эффективно обернуть его в контейнер
- Ваш проект имеет привязанные к конкретному хосту зависимости (например, вам нужно напрямую взаимодействовать с оборудованием конкретного сервера). Тогда - вы врядли сможете использовать контейнеризацию, можете не пытаться
